<!--
  Generated template for the ReceiptsPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-content fullscreen #content>

    <ion-list *ngFor="let year of years">
        <ion-item-group>

            <div class="year">

                <p>{{ year }}</p>

            </div>

        </ion-item-group>

        <div *ngFor="let receiptMap of mappedReceipts">
            <div *ngFor="let receiptYear of receiptMap[year]; let i = index">
                <div *ngFor="let month of months" id="{{month}}">

                    <div *ngIf="receiptYear[month] && i == 0">
                        
                        <accordion [monthTitle]="month" [firstAccordion]="true">
                                <div *ngFor="let receiptMonth of receiptYear[month]">

                                    <div *ngFor="let day of days">
                                        <div *ngIf="receiptMonth[day]">
                                            <p class="dayname">{{day}}</p>
                                            <div class="day">
                                                <div *ngFor="let receipt of receiptMonth[day]">
                                                    <button class="receiptbtn" (click)="goToReceipt(receipt)">

                                                        <div class="merchant half">
                                                            <p class="name">
                                                                {{receipt.merchant.name}}
                                                            </p>
                                                            <p class="city">
                                                                {{receipt.merchant.city}}
                                                            </p>
                                                        </div>
                                                        <div class="info half">
                                                            <div class="sum">
                                                                <p class="total">
                                                                    {{receipt.sum.total.toLocaleString(undefined, {useGrouping: true, minimumFractionDigits: 2, maximumFractionDigits: 2}) }}
                                                                </p>
                                                                <p class="currency">
                                                                    {{receipt.sum.currency}}
                                                                </p>
                                                            </div>
                                                            <p class="time">{{receipt.receipt.time.slice(0,-3)}}</p>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                        </accordion>

                    </div>
                    <div *ngIf="receiptYear[month] && i > 0">
                        
                            <accordion [monthTitle]="month">
                                    <div *ngFor="let receiptMonth of receiptYear[month]">
    
                                        <div *ngFor="let day of days">
                                            <div *ngIf="receiptMonth[day]">
                                                <p class="dayname">{{day}}</p>
                                                <div class="day">
                                                    <div *ngFor="let receipt of receiptMonth[day]">
                                                        <button class="receiptbtn" (click)="goToReceipt(receipt)">
    
                                                            <div class="merchant half">
                                                                <p class="name">
                                                                    {{receipt.merchant.name}}
                                                                </p>
                                                                <p class="city">
                                                                    {{receipt.merchant.city}}
                                                                </p>
                                                            </div>
                                                            <div class="info half">
                                                                <div class="sum">
                                                                    <p class="total">
                                                                        {{receipt.sum.total.toLocaleString(undefined, {useGrouping: true, minimumFractionDigits: 2, maximumFractionDigits: 2}) }}
                                                                    </p>
                                                                    <p class="currency">
                                                                        {{receipt.sum.currency}}
                                                                    </p>
                                                                </div>
                                                                <p class="time">{{receipt.receipt.time.slice(0,-3)}}</p>
                                                            </div>
                                                        </button>
                                                    </div>
                                                </div>
    
                                            </div>
                                        </div>
                                    </div>
                            </accordion>
    
                        </div>
                </div>
            </div>
        </div>

    </ion-list>



</ion-content>
<!--
<ion-footer>
    <ion-toolbar>
        <button ion-button full clear icon-end (click)="goToCards()">
            Your cards
            <ion-icon name="play"></ion-icon>
        </button>
    </ion-toolbar>
</ion-footer>-->