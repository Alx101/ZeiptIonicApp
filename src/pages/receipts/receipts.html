<!-- HEADER -->
<ion-header class="header">
    <ion-navbar>
        <div class="header-row">
            <div class="column left" (click)="search()">
                <ion-icon id="search" name="search"></ion-icon>
                <span id="searchtxt">Search</span>
            </div>
            <div class="column center">
                <img class="receiptguy small" src="../assets/img/receiptguy.svg" alt="">
            </div>
            <div *ngIf="cards.length == 0" class="column right" (click)="goToCards()">
                <p class="notify">Add card</p>
            </div>
            <div *ngIf="cards.length > 0" class="column right" (click)="goToCards()">Your cards</div>
        </div>
    </ion-navbar>
</ion-header>

<!-- CONTENT -->
<ion-content #content (ionScroll)="scrollHandler($event)">
    <div ion-fixed id="fixedbg">
    </div>
    <div ion-fixed id="monthList">
        <div *ngFor="let receiptObject of structuredReceipts; let i = index">
            <div class="navyear" *ngIf="receiptObject == structuredReceipts[0] || receiptObject.year != structuredReceipts[i-1].year">
                <p>{{receiptObject.year}}</p>
            </div>
            <div (click)="scrollToMonth(receiptObject.month + i)" class="quickselect" *ngIf="receiptObject == structuredReceipts[0] || receiptObject.month != structuredReceipts[i-1].month">
                <p>{{receiptObject.month}}</p>
            </div>
        </div>
    </div>
    <div (click)="toggleList()" ion-fixed id="fade">
    </div>
    <div (click)="toggleList()" *ngIf="structuredReceipts.length != 0" ion-fixed id="fixedbtn">
        <p id="fixedbtnmonth">Get list of months</p>
        <p id="fixedbtnyear"></p>
        <ion-icon id="arrow" name="arrow-down"></ion-icon>
    </div>

    <ion-searchbar ion-fixed placeholder="Search for date, merchant, city or price" id="searchbar" (ionInput)="getItems($event)"></ion-searchbar>

    <!-- IF NO RECEIPTS â€“ Show message -->
    <div *ngIf="structuredReceipts.length == 0" class="info-content">
        <div class="centered">
            <div class="centered-cell">
                <img class="receiptguy big" src="../assets/img/zeiptreceipt.svg" alt="">
                <p>This page will shortly be filled with your digital receipts.</p>
                <br>
                <p *ngIf="cards.length > 0">Just stay tuned!</p>
                <p *ngIf="cards.length == 0">Start by adding your card:</p>
                <button *ngIf="cards.length == 0" class="primary" (click)="newCard()">Add card</button>
            </div>
        </div>
    </div>



    <ion-list *ngFor="let receiptObject of structuredReceipts; let i = index">

        <div id="{{receiptObject.year}}" class="year" *ngIf="receiptObject == structuredReceipts[0] || receiptObject.year != structuredReceipts[i-1].year">
            <p>{{receiptObject.year}}</p>
        </div>

        <div id="{{receiptObject.month + i}}" class="month" *ngIf="receiptObject == structuredReceipts[0] || receiptObject.month != structuredReceipts[i-1].month">
            <p>{{receiptObject.month}}</p>
        </div>

        <div class="datenr" *ngIf="receiptObject == structuredReceipts[0] || receiptObject.datenr != structuredReceipts[i-1].datenr">
            <p>{{receiptObject.datenr}}. {{receiptObject.day}}</p>
        </div>
        <div class="day">
            <button class="receiptbtn" (click)="goToReceipt(receiptObject.receipt)">
                <div class="merchant half">
                    <p class="name">
                        {{receiptObject.receipt.merchant.name}}
                    </p>
                    <p class="city">
                        {{receiptObject.receipt.merchant.city}}
                    </p>
                </div>
                <div class="info half">
                    <div class="sum">
                        <p class="total">
                            {{receiptObject.receipt.sum.total.toLocaleString(undefined, { useGrouping: true, minimumFractionDigits: 2, maximumFractionDigits:
                            2}) }}
                        </p>
                        <p class="currency">
                            {{receiptObject.receipt.sum.currency}}
                        </p>
                    </div>
                    <p class="time">{{receiptObject.time}}</p>
                </div>
            </button>
        </div>


    </ion-list>


    <p *ngIf="structuredReceipts.length != 0" class="endofreceipts">That's all folks!</p>
</ion-content>